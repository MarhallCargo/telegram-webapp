<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ó–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</title>
</head>
<body>
    <h1>–ó–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h1>

    {% if topups %}
        <ul>
        {% for req in topups %}
            <li>
                <strong>{{ req.user.username }}</strong> –∑–∞–ø—Ä–æ—Å–∏–ª {{ req.rub_amount }} —Ä—É–± (‚âà {{ req.cny_amount }} ¬•)
                <br>–°—Ç–∞—Ç—É—Å: {{ req.status }}

                {% if req.status == 'waiting_for_details' or (req.status == 'waiting_for_confirmation' and not req.payment_details) %}
                    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ -->
                    <form action="/admin/topups/{{ req.id }}/add_details" method="post" style="margin-top:5px;">
                        <input type="text" name="payment_details" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã" required>
                        <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã</button>
                    </form>
                {% endif %}

                {% if req.status == 'waiting_for_confirmation' %}
                    {% if req.payment_proof_path %}
                        <p>üìé –§–∞–π–ª –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞: <a href="/{{ req.payment_proof_path }}" target="_blank">–°–∫–∞—á–∞—Ç—å</a></p>
                    {% else %}
                        <p style="color: orange;">‚ö†Ô∏è –ë–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–µ–≥–æ —Ñ–∞–π–ª–∞!</p>
                    {% endif %}
                    <form action="/admin/topups/{{ req.id }}/confirm" method="post" style="display:inline;">
                        <button type="submit">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                    </form>
                    <form action="/admin/topups/{{ req.id }}/reject" method="post" style="display:inline;">
                        <button type="submit">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                    </form>
                {% endif %}

                {% if req.status == 'waiting_for_payment' %}
                    <p style="color: gray;">‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞</p>
                {% endif %}

                <hr>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫.</p>
    {% endif %}

    <a href="/admin/dashboard">‚Üê –ù–∞–∑–∞–¥ –≤ –∞–¥–º–∏–Ω–∫—É</a>
</body>
</html>
